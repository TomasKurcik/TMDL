createOrReplace

	table dDates

		column Date
			formatString: yyyy-mm-dd
			summarizeBy: none
			isNameInferred
			sourceColumn: [Date]

			annotation SummarizationSetBy = Automatic

			annotation UnderlyingDateTimeDataType = Date

			annotation PBI_FormatHint = {"isDateTimeCustom":true}

		column Year
			formatString: 0
			summarizeBy: none
			isNameInferred
			sourceColumn: [Year]

			annotation SummarizationSetBy = Automatic

		column Quarter
			formatString: 0
			summarizeBy: none
			isNameInferred
			sourceColumn: [Quarter]

			annotation SummarizationSetBy = Automatic

		column 'Month No'
			formatString: 0
			summarizeBy: none
			isNameInferred
			sourceColumn: [Month No]

			annotation SummarizationSetBy = Automatic

		column 'Month Name'
			summarizeBy: none
			isNameInferred
			sourceColumn: [Month Name]
			sortByColumn: 'Month No'

			annotation SummarizationSetBy = Automatic

		column Day
			formatString: 0
			summarizeBy: none
			isNameInferred
			sourceColumn: [Day]

			annotation SummarizationSetBy = Automatic

		column 'Week No'
			formatString: 0
			summarizeBy: none
			isNameInferred
			sourceColumn: [Week No]

			annotation SummarizationSetBy = Automatic

		column 'Week Day No'
			formatString: 0
			summarizeBy: none
			isNameInferred
			sourceColumn: [Week Day No]

			annotation SummarizationSetBy = Automatic

		column 'Week Day Name'
			summarizeBy: none
			isNameInferred
			sourceColumn: [Week Day Name]
			sortByColumn: 'Week Day No'

			annotation SummarizationSetBy = Automatic

		column 'Day Type'
			summarizeBy: none
			isNameInferred
			sourceColumn: [Day Type]

			annotation SummarizationSetBy = Automatic

		column 'Offset Year'
			formatString: 0
			summarizeBy: none
			isNameInferred
			sourceColumn: [Offset Year]

			annotation SummarizationSetBy = Automatic

		column 'Offset Quarter'
			formatString: 0
			summarizeBy: none
			isNameInferred
			sourceColumn: [Offset Quarter]

			annotation SummarizationSetBy = Automatic

		column 'Offset Month'
			formatString: 0
			summarizeBy: none
			isNameInferred
			sourceColumn: [Offset Month]

			annotation SummarizationSetBy = Automatic

		column 'Offset Week'
			formatString: 0
			summarizeBy: none
			isNameInferred
			sourceColumn: [Offset Week]

			annotation SummarizationSetBy = Automatic

		column 'Offset Day'
			summarizeBy: none
			isNameInferred
			sourceColumn: [Offset Day]

			annotation SummarizationSetBy = Automatic

			annotation PBI_FormatHint = {"isGeneralNumber":true}

		column 'Date value'
			summarizeBy: none
			isNameInferred
			sourceColumn: [Date value]

			annotation SummarizationSetBy = Automatic

			annotation PBI_FormatHint = {"isGeneralNumber":true}

		column YearMonth
			summarizeBy: none
			isNameInferred
			sourceColumn: [YearMonth]

			annotation SummarizationSetBy = Automatic

			annotation PBI_FormatHint = {"isGeneralNumber":true}

		column 'Month Start'
			formatString: yyyy-mm-dd
			summarizeBy: none
			isNameInferred
			sourceColumn: [Month Start]

			annotation UnderlyingDateTimeDataType = Date

			annotation SummarizationSetBy = Automatic

			annotation PBI_FormatHint = {"isDateTimeCustom":true}

		column 'Month End'
			formatString: yyyy-mm-dd
			summarizeBy: none
			isNameInferred
			sourceColumn: [Month End]

			annotation SummarizationSetBy = Automatic

			annotation UnderlyingDateTimeDataType = Date

			annotation PBI_FormatHint = {"isDateTimeCustom":true}

		column 'Quarter Start'
			formatString: yyyy-mm-dd
			summarizeBy: none
			isNameInferred
			sourceColumn: [Quarter Start]

			annotation SummarizationSetBy = Automatic

			annotation UnderlyingDateTimeDataType = Date

			annotation PBI_FormatHint = {"isDateTimeCustom":true}

		column 'Quarter End'
			formatString: yyyy-mm-dd
			summarizeBy: none
			isNameInferred
			sourceColumn: [Quarter End]

			annotation SummarizationSetBy = Automatic

			annotation UnderlyingDateTimeDataType = Date

			annotation PBI_FormatHint = {"isDateTimeCustom":true}

		hierarchy '_Year Quarter Month No Day'

			level Year
				column: Year

			level Quarter
				column: Quarter

			level 'Month No'
				column: 'Month No'

			level Day
				column: Day

		hierarchy '_Year Week Day'

			level Year
				column: Year

			level 'Week No'
				column: 'Week No'

			level Day
				column: Day

		hierarchy '_Year Month No Day'

			level Year
				column: Year

			level 'Month No'
				column: 'Month No'

			level Day
				column: Day

		hierarchy '_Year Month Name Day'

			level Year
				column: Year

			level 'Month Name'
				column: 'Month Name'

			level Day
				column: Day

		hierarchy '_Month Name Year'

			level 'Month Name'
				column: 'Month Name'

			level Year
				column: Year

		hierarchy '_Year Month Name'

			level Year
				column: Year

			level 'Month Name'
				column: 'Month Name'

		partition dDates = calculated
			mode: import
			source = ```
					
					// Set Number of years you want to start and end this table.
					VAR YearsPrior = 5
					VAR YearsFuture = 1
					
					// Set the language you wish the DAX code to use when creating names on weeks, months etc.
					VAR Locale = "en-US"
					
					
					
					// Execute table calculations
					VAR StartDate = DATE(YEAR(TODAY())-YearsPrior,1,1)
					VAR EndDate = DATE(YEAR(TODAY())+YearsFuture,12,31)
					
					VAR CalendarTable = 
					    CALENDAR(DATEVALUE(StartDate),DATEVALUE(EndDate))
					
					Return
					SELECTCOLUMNS(CalendarTable,
					    "Date",
					        [Date],
					    "Year",
					        YEAR([Date]),
					    "Date value",
					        VALUE(
					            FORMAT(
					                [Date],
					                "YYYYMMDD"
					            )
					        )
					        ,
					    "YearMonth",
					        VALUE(
					            FORMAT(
					                [Date],
					                "YYYYMM"
					            )
					        )
					        , 
					    "Quarter",
					        QUARTER([Date]),
					    "Month No",
					        MONTH([Date]),
					    "Month Name",
					        UPPER(
					            LEFT(
					                FORMAT([Date],"MMMM",Locale),
					                1
					            )
					        )&
					        MID(
					            FORMAT([Date],"MMMM",Locale),
					            2,
					            20
					        ),
					    "Day",
					        DAY([Date]),
					    "Week No",
					        WEEKNUM([Date],21),
					    "Week Day No",
					        WEEKDAY([Date],2),
					    "Week Day Name",
					        UPPER(
					            LEFT(
					                FORMAT([Date],"DDDD",Locale),
					                1
					            )
					        )&
					        MID(
					            FORMAT([Date],"DDDD",Locale),
					            2,
					            20
					        ),
					    "Day Type",
					        IF(
					            WEEKDAY([Date],2) > 5,
					            "Weekend",
					            "Work day"
					        ),
						"Month Start",
							DATE(YEAR([Date]), MONTH([Date]), 1),
						"Month End",
							EOMONTH([Date], 0),
						"Quarter Start",
							DATE(YEAR([Date]), (QUARTER([Date]) - 1) * 3 + 1, 1),
						"Quarter End",
							EOMONTH(DATE(YEAR([Date]), QUARTER([Date]) * 3, 1), 0),
					    "Offset Year",
					        YEAR([Date]) - YEAR(TODAY()),
					    "Offset Quarter",
					        (
					            QUARTER([Date]) - QUARTER(TODAY())
					        )
					        +
					        (
					            YEAR([Date]) - YEAR(TODAY())
					        ) * 4,
					    "Offset Month",
					        (
					            MONTH([Date]) - MONTH(TODAY())
					        )
					        +
					        (
					            YEAR([Date]) - YEAR(TODAY())
					        ) * 12,
					    "Offset Week",
					        DATEDIFF([Date], TODAY(), WEEK),
					    "Offset Day",
					        DATEDIFF([Date], TODAY(), DAY)
					) 
					```
