createOrReplace

	table 'Time Intelligence'

		calculationGroup
			precedence: 10

			calculationItem 'Current Period' =
				SELECTEDMEASURE()
				

			calculationItem 'Previous Year' =
				CALCULATE(
					SELECTEDMEASURE(),
					SAMEPERIODLASTYEAR('Dates'[Date])
				)
				
					

			calculationItem 'Year Over Year' =
				CALCULATE(
					SELECTEDMEASURE(),
					SAMEPERIODLASTYEAR('Dates'[Date])
				)
				
					

			calculationItem 'Year Over Year %' =
				VAR CurrentValue = SELECTEDMEASURE()
				VAR Previous_Year = 
					CALCULATE(
						SELECTEDMEASURE(),
						SAMEPERIODLASTYEAR('Dates'[Date])
					)
				RETURN
					DIVIDE(CurrentValue - Previous_Year, Previous_Year)
				
					

			calculationItem 'Year To Date' =
				CALCULATE(
					SELECTEDMEASURE(),
					DATESYTD('Dates'[Date])
				)
				
					

			calculationItem 'Previous Year YTD' =
				CALCULATE(
					SELECTEDMEASURE(),
					DATESYTD('Dates'[Date]),
					SAMEPERIODLASTYEAR('Dates'[Date])
				)
				
					

			calculationItem 'YTD vs PY YTD' =
				VAR CurrentYTD = 
					CALCULATE(
						SELECTEDMEASURE(),
						DATESYTD('Dates'[Date])
					)
				VAR PreviousYTD = 
					CALCULATE(
						SELECTEDMEASURE(),
						DATESYTD('Dates'[Date]),
						SAMEPERIODLASTYEAR('Dates'[Date])
					)
				RETURN
					DIVIDE(CurrentYTD - PreviousYTD, PreviousYTD)
				
					

			calculationItem 'Month To Date' =
				CALCULATE(
					SELECTEDMEASURE(),
					DATESMTD('Dates'[Date])
				)
				
					

			calculationItem 'Quarter To Date' =
				CALCULATE(
					SELECTEDMEASURE(),
					DATESQTD('Dates'[Date])
				)
				
					

			calculationItem 'Previous Month' =
				CALCULATE(
					SELECTEDMEASURE(),
					DATEADD('Dates'[Date], -1, MONTH)
				)
				
					

			calculationItem 'Previous Quarter' =
				CALCULATE(
					SELECTEDMEASURE(),
					DATEADD('Dates'[Date], -1, QUARTER)
				)
				
					

			calculationItem 'Moving Annual Total' =
				CALCULATE(
					SELECTEDMEASURE(),
					DATESINPERIOD(
						'Dates'[Date],
						LASTDATE('Dates'[Date]),
						-1,
						YEAR
					)
				)
				
					

			calculationItem '3 Month Moving Average' =
				CALCULATE(
					AVERAGEX(
						DATESINPERIOD(
							'Dates'[Date],
							LASTDATE('Dates'[Date]),
							-3,
							MONTH
						),
						SELECTEDMEASURE()
					)
				)
				
					

		column Name
			dataType: string
			sourceColumn: Name

		column Ordinal
			dataType: int64
			sourceColumn: Ordinal
			isHidden


			
